/*! For license information please see laser_eyes.bundle.js.LICENSE.txt */
(()=>{"use strict";var e,n={2694:(e,n,t)=>{t.d(n,{Dd:()=>x,S1:()=>b,dJ:()=>m,rr:()=>y}),t(9059);var o=t(3224),a=t(999),r=t(7155),l=t(3644),i=t(8734);const c=!1;let s,u,f,d,v,g=0,p=0,h=0;const m={stats:f,beginStats:function(){},endStats:function(){}},y={onChanged:function(e){},onCameraChanged:function(e){},onGUIConstructed:function(e){}};function _(){d=(performance||Date).now()}function w(){const e=(performance||Date).now();if(p+=e-d,++g,e-h>=1e3){const n=p/g;p=0,g=0,f.customFpsPanel.update(1e3/n,120),h=e}}async function x(e=!0){let n=null;return await async function(){if((r.ed.isTargetFPSChanged||r.ed.isSizeOptionChanged)&&(u=await o.V.setupCamera(r.ed.camera),r.ed.isTargetFPSChanged=!1,r.ed.isSizeOptionChanged=!1,y.onCameraChanged(u)),r.ed.isModelChanged||r.ed.isFlagChanged||r.ed.isBackendChanged){r.ed.isModelChanged=!0,window.cancelAnimationFrame(v),null!=s&&s.dispose(),(r.ed.isFlagChanged||r.ed.isBackendChanged)&&await(0,i.Qt)(r.ed.flags,r.ed.backend);try{s=await(0,r.cH)(r.ed.model)}catch(e){s=null,alert(e)}r.ed.isFlagChanged=!1,r.ed.isBackendChanged=!1,r.ed.isModelChanged=!1}}(),r.ed.isModelChanged||(n=async function(e){u.video.readyState<2&&await new Promise((e=>{u.video.onloadeddata=()=>{e()}}));let n=null;if(null!=s){c&&_();try{n=await s.estimateFaces(u.video,{flipHorizontal:!1}),y.onChanged(n)}catch(e){s.dispose(),s=null,alert(e)}c&&w()}return e&&(document.querySelector(".camera-canvas-wrapper").style.display="block",u.drawCtx(),n&&n.length>0&&!r.ed.isModelChanged&&u.drawResults(n,r.ed.modelConfig.triangulateMesh,r.ed.modelConfig.boundingBox)),n}(e)),n}async function b(){const e=new URLSearchParams(window.location.search),n=await(0,a.j)(e);y.onGUIConstructed(n),f=(0,l.t)(),m.stats=f,m.beginStats=_,m.endStats=w,u=await o.V.setupCamera(r.ed.camera),y.onCameraChanged(u),await(0,i.Qt)(r.ed.flags,r.ed.backend),s=await(0,r.cH)(),console.log("face detector created")}},6893:(e,n,t)=>{var o,a,r,l,i,c,s,u=t(8761),f=t(2694),d=t(9477),v="\n//#version 420 core\n// Stupid Apple.\n// #version 330 core\nprecision highp float;\nout vec2 v_uv;\nvoid main()\n{\n    gl_Position = vec4(position, 1);\n    v_uv = uv;\n}\n",g=function(e,n,t,o){return new(t||(t=Promise))((function(a,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,i)}c((o=o.apply(e,n||[])).next())}))},p=function(e,n){var t,o,a,r,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;r&&(r=0,i[0]&&(l=0)),l;)try{if(t=1,o&&(a=2&i[0]?o.return:i[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,i[1])).done)return a;switch(o=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!((a=(a=l.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){l.label=i[1];break}if(6===i[0]&&l.label<a[1]){l.label=a[1],a=i;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(i);break}a[2]&&l.ops.pop(),l.trys.pop();continue}i=n.call(e,l)}catch(e){i=[6,e],o=0}finally{t=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};function h(){}function m(e){return new d.Pa4(e.x,e.y,e.z)}var y=0,_=Date.now();function w(){(function(){return g(this,void 0,void 0,(function(){var e;return p(this,(function(n){return e=_,_=Date.now(),y+=_-e,[2]}))}))})().then((function(){return f.dJ.beginStats()})).then((function(){return(0,f.Dd)(!1)})).then((function(e){requestAnimationFrame(w);for(var n=0;n<e.length;n++){var t=m(e[n].keypoints[152]),u=m(e[n].keypoints[23]),f=m(e[n].keypoints[253]),v=e[n].box.width;t.z*=-v,u.z*=-v,f.z*=-v;var g=m(e[n].keypoints[33]),p=m(e[n].keypoints[133]),h=m(e[n].keypoints[362]),_=m(e[n].keypoints[263]),x=u.sub(t).normalize(),b=f.sub(t).normalize(),C=x.cross(b).normalize(),S=c/s,k=new d.FM8(1/c*g.x,1/s*g.y),z=new d.FM8(1/c*p.x,1/s*p.y),A=5*k.sub(z).length(),F=l.material.uniforms;F.effect_mask.value=7,F.glow_scale.value=A,F.time.value=y/1e3,F.texture_ar.value=S,F.tc_laser_offset.value.set(.1*C.x,.1*C.y),F.laser_dir.value.copy(C),F.glow_color.value.set(1,1,0,1),F.glare_color.value.set(1,0,0,1),F.left_laser.value.set(1/c*g.x*S,1/s*g.y,1/c*p.x*S,1/s*p.y),F.right_laser.value.set(1/c*h.x*S,1/s*h.y,1/c*_.x*S,1/s*_.y),l.material.uniformsNeedUpdate=!0,a.setRenderTarget(r),a.render(l,o)}a.setRenderTarget(null),a.render(i,o)})).then((function(){return f.dJ.endStats()}))}u.r.onCameraChanged=function(e){c=e.video.videoWidth,s=e.video.videoHeight,a&&(a.setSize(c,s),r.setSize(c,s))},function(){g(this,void 0,void 0,(function(){return p(this,(function(e){return u.S().then((function(){(o=new d.iKG(-1,1,1,-1,0,1)).position.z=.01;var e=document.getElementById("camera-video"),n=new d.fO1(e),t=new d._12(2,2),c=new d.jyz({fragmentShader:"\n//#version 420 core\n// Stupid Apple.\n// #version 330 core\nprecision highp float;\n\nin vec2 v_uv;\n\nuniform vec4 left_laser;\nuniform vec4 right_laser;\nuniform vec3 laser_dir;\nuniform float time;\nuniform float texture_ar;\nuniform vec2 tc_laser_offset;\nuniform vec4 glare_color;\nuniform vec4 glow_color;\nuniform int effect_mask;\nuniform float glow_scale;\n\nvec3 hash3( vec2 p )\n{\n    vec3 q = vec3( dot(p,vec2(127.1,311.7)), \n                   dot(p,vec2(269.5,183.3)), \n                   dot(p,vec2(419.2,371.9)) );\n    return fract(sin(q)*43758.5453);\n}\n\nfloat voronoise( in vec2 p, float u, float v )\n{\n    float k = 1.0+63.0*pow(1.0-v,6.0);\n\n    vec2 i = floor(p);\n    vec2 f = fract(p);\n    \n    vec2 a = vec2(0.0,0.0);\n    for( int y=-2; y<=2; y++ )\n    for( int x=-2; x<=2; x++ )\n    {\n        vec2  g = vec2( x, y );\n        vec3  o = hash3( i + g )*vec3(u,u,1.0);\n        vec2  d = g - f + o.xy;\n        float w = pow( 1.0-smoothstep(0.0,1.414,length(d)), k );\n        a += vec2(o.z*w,w);\n    }\n    \n    return a.x/a.y;\n}\n\nfloat noise(in vec2 p)\n{\n    return voronoise(p, 1.0, 1.0);\n}\n\nfloat noise(in float p)\n{\n    return noise(vec2(p));\n}\n//const mat2 m2 = mat2(0.8,-0.6,0.6,0.8);\n//float fbm( in vec2 p ){\n//    float f = 0.0;\n//    f += 0.5000*noise( p ); p = m2*p*2.02;\n//    f += 0.2500*noise( p ); p = m2*p*2.03;\n//    f += 0.1250*noise( p ); p = m2*p*2.01;\n//    f += 0.0625*noise( p );\n//\n//    return f/0.9375;\n//}\n\nfloat segment_d(vec2 P, vec2 A, vec2 B) \n{\n    vec2 g = B - A;\n    vec2 h = P - A;\n    return length(h - g * clamp(dot(g, h) / dot(g,g), 0.0, 1.0));\n}\n\nfloat segment(vec2 P, vec2 A, vec2 B, float r) \n{\n    vec2 g = B - A;\n    vec2 h = P - A;\n    float d = length(h - g * clamp(dot(g, h) / dot(g,g), 0.0, 1.0));\n    return smoothstep(r, r*0.5, d);\n}\n\nfloat sideflare(vec2 P, vec2 A, vec2 B, float r, float len) \n{\n    //P *= 10.0;\n    //A *= 10.0;\n    //B *= 10.0;\n    //A.y = B.y = 0.5*(A.y + B.y);\n    vec2 AA = mix(B,A, len);\n    vec2 BB = mix(A,B, len);\n    vec2 g = BB - AA;\n    vec2 h = P - AA;\n    vec2 c = 0.5*(A+B);\n    \n    float d = length(h - g * clamp(dot(g, h) / dot(g,g), 0.0, 1.0));\n    float d2 = pow(10.0*distance(c,P), 1.0);\n    //return smoothstep(0.01, 0.01*0.5, d);\n    //return 0.3*smoothstep(distance(AA,BB)*0.005, 0.0, d2);\n    //return 0.5*smoothstep(r, 0.0, mix(d, d*d2, 0.5));// * smoothstep(distance(AA,BB)*0.5, 0.0, d2);\n    //return smoothstep(r, 0.0, d)/(1.0 + d2);\n    return 0.15*smoothstep(r, 0.0, d) * smoothstep(len, 0.0 ,d2);\n}\n\nvec2 lensflare(vec2 uv,vec2 pos)\n{\n    uv  *= 2.0/glow_scale;\n    pos *= 2.0/glow_scale;\n    vec2 main = uv-pos;\n    //return(step(length(main), 1.0));\n    vec2 uvd = uv*(length(uv));\n    \n    float ang = atan(main.x,main.y);\n    float dist=length(main);\n    float n = noise(vec2(ang*8.0,dist*32.0));\n    \n    float f0 = 1.0/(length(uv-pos)*16.0+1.0);\n    //f0 = f0+f0*(sin(noise(sin(ang*2.+10.0*pos.x)*4.0 - cos(ang*3.+10.0*pos.y))*16.)*.1 + dist*.1 + .8);\n    //return f0;\n    float f1 = (sin(noise(sin(ang*2.+10.0*pos.x)*4.0 - cos(ang*3.+10.0*pos.y))*16.)*.1 + dist*.1 + .8);\n    return vec2(2.*smoothstep(0.1, .8, f0), f1*f1*smoothstep(0., .3,f0));\n}\n\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid main(){\n    vec2 tc = vec2(v_uv.x*texture_ar, v_uv.y);\n    vec2 ll = 0.5*(left_laser.xy  + left_laser.zw);\n    vec2 rl = 0.5*(right_laser.xy + right_laser.zw);\n    const float laser_len = 10.0;\n\n    float lasers = 0.0;\n    if((effect_mask & 4) != 0)\n    {\n        lasers = smoothstep(0.05, -0.05, segment_d(tc, ll, ll + laser_len*laser_dir.xy))\n               + smoothstep(0.05, -0.05, segment_d(tc,  rl, rl + laser_len*laser_dir.xy));\n        lasers *= 0.5*(1.0+noise( 48.0*tc + 500.0*tc_laser_offset));\n    }\n\n    vec2 eyes = vec2(0.0);\n    if((effect_mask & 1) != 0)\n    {\n        eyes += max(lensflare(tc, ll),\n                   lensflare(tc, rl));\n    }\n    if((effect_mask & 2) != 0)\n    {\n        eyes.y += sideflare(tc, ll, rl, 0.005, 8.0);\n    }\n    \n    gl_FragColor.a += eyes.x + eyes.y + lasers;\n    vec4 eye_color = mix(\n        clamp(glare_color + vec4(0, 0.25*sin(2.0*time), 0, 1), vec4(0), vec4(1)),\n        glow_color,\n        eyes.x);\n    gl_FragColor.a = clamp(gl_FragColor.a*eye_color.a, 0., 1.);\n    gl_FragColor.xyz = smoothstep(0.05, 0.2, gl_FragColor.a)*eye_color.rgb;\n    // gl_FragColor.rgb = vec3(mod(time,1.0), 0,0);\n}\n",vertexShader:v,uniforms:{effect_mask:{value:0},glow_scale:{value:0},time:{value:0},texture_ar:{value:0},tc_laser_offset:{value:new d.FM8},laser_dir:{value:new d.Pa4},glow_color:{value:new d.Ltg},glare_color:{value:new d.Ltg},left_laser:{value:new d.Ltg},right_laser:{value:new d.Ltg}}});l=new d.Kj0(t,c),r=new d.dd2(e.width,e.height);var s=new d.jyz({fragmentShader:"\n//#version 420 core\n// Stupid Apple.\n// #version 330 core\nprecision highp float;\n\nuniform sampler2D image;\nuniform sampler2D effect;\nin vec2 v_uv;\nvoid main(){\n    vec2 uv1 = vec2(1,0) + vec2(-1,1)*v_uv;\n    vec2 uv2 = vec2(1,1) + vec2(-1,-1)*v_uv;\n    vec4 orig = texture(image, uv1);\n    vec4 col = texture(effect, uv2);\n    gl_FragColor.xyz = mix(orig.xyz, col.xyz, min(1.0, col.a));\n    // gl_FragColor.xyz = col.aaa;\n    //gl_FragColor.xyz = col.aaa;\n    //gl_FragColor = 0.5*(texture(image, v_uv) + texture(effect, v_uv));\n    //gl_FragColor = texture(image, v_uv)*texture(effect, v_uv);\n    // gl_FragColor = col;\n    gl_FragColor.a = 1.0;\n}\n",vertexShader:v,uniforms:{image:{value:n},effect:{value:r.texture}}});i=new d.Kj0(t,s);var u=document.getElementById("effect-canvas");null!=u&&((a=new d.CP7({antialias:!1,canvas:u,depth:!1})).setSize(e.width,e.height),a.setClearColor(new d.Ilk(.2,0,0)),a.clearColor(),window.addEventListener("resize",h))})).then(w),[2]}))}))}()}},t={};function o(e){var a=t[e];if(void 0!==a)return a.exports;var r=t[e]={id:e,loaded:!1,exports:{}};return n[e].call(r.exports,r,r.exports,o),r.loaded=!0,r.exports}o.m=n,o.amdD=function(){throw new Error("define cannot be used indirect")},o.amdO={},e=[],o.O=(n,t,a,r)=>{if(!t){var l=1/0;for(u=0;u<e.length;u++){for(var[t,a,r]=e[u],i=!0,c=0;c<t.length;c++)(!1&r||l>=r)&&Object.keys(o.O).every((e=>o.O[e](t[c])))?t.splice(c--,1):(i=!1,r<l&&(l=r));if(i){e.splice(u--,1);var s=a();void 0!==s&&(n=s)}}return n}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[t,a,r]},o.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return o.d(n,{a:n}),n},o.d=(e,n)=>{for(var t in n)o.o(n,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={10:0};o.O.j=n=>0===e[n];var n=(n,t)=>{var a,r,[l,i,c]=t,s=0;if(l.some((n=>0!==e[n]))){for(a in i)o.o(i,a)&&(o.m[a]=i[a]);if(c)var u=c(o)}for(n&&n(t);s<l.length;s++)r=l[s],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(u)},t=self.webpackChunkdimension_stream_github_io=self.webpackChunkdimension_stream_github_io||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var a=o.O(void 0,[956,477,728],(()=>o(6893)));a=o.O(a)})();